ead.table('../data/support_materials/GSE30931_series_matrix.txt', sep = '\t', comment.char = '!', fill = T, header = T)
box_data = exprSet
rownames(exprSet) = exprSet[,1]
rownames(exprSet)
exprSet = exprSet[,-1]
View(exprSet)
class(exprSet)
str(exprSet)
write.csv(exprSet, "../data/support_materials/GSE30931_exprSet.csv")
exprSet = read.table('../data/support_materials/GSE30931_series_matrix.txt', sep = '\t', comment.char = '!', fill = T, header = T)
box_data = exprSet
rownames(exprSet) = exprSet[,1]
rownames(exprSet)
exprSet = exprSet[,-1]
View(exprSet)
class(exprSet)
str(exprSet)
write.csv(exprSet, "../data/support_materials/GSE30931_exprSet.csv")
library(reshape2)
group_list = c(rep('control', 3), rep('Estrogen', 3), rep('Velcade', 3), rep('Estrogen (6 h) + Velcade', 3))
exprSet_L = melt(box_data)
colnames(exprSet_L) = c('probe', 'sample', 'value')
exprSet_L$group = rep(group_list, each=nrow(exprSet))
head(exprSet_L)
library(ggplot2)
p = ggplot(exprSet_L, aes(x=sample, y=value, fill=group)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5))
print(p)
ggsave(
filename = "../data/support_materials/GSE30931_boxPlot.png",
width = 10,
height = 10,
units = 'in',
dpi = 500
)
## PCA
library(ggfortify)
df = as.data.frame(t(exprSet))
df$group = group_list
png(filename = "../data/support_materials/GSE30931_PCA.png")
autoplot(prcomp(df[,1:(ncol(df)-1)]), data=df, colour='group')
dev.off()
## id mapping
library(illuminaHumanv4.db)
ids = toTable(illuminaHumanv4UNIPROT)
write.csv(ids, "../data/support_materials/GSE30931_ids.csv")
